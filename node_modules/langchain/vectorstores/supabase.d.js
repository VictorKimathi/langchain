// vectorstores/supabase.js

import { createClient } from '@supabase/supabase-js';

export class SupabaseVectorStore {
  constructor({ supabaseUrl, supabaseKey, tableName }) {
    this.client = createClient(supabaseUrl, supabaseKey);
    this.tableName = tableName;
  }

  async fromDocuments(documents, embeddings, options = {}) {
    try {
      const data = documents.map((doc) => ({
        text: doc.text,
        embedding: embeddings.embed(doc.text),
      }));

      const { error } = await this.client
        .from(this.tableName)
        .insert(data);

      if (error) throw error;
    } catch (error) {
      console.error('Error inserting documents:', error);
    }
  }
}
